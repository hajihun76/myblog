{% extends "blog_base/base_with_navbar.html" %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'community/css/navbar_override.css' %}">
{% endblock extra_head %}

{% block title %}자유게시판{% endblock title %}

{% block content %}

<!-- ✅ 커뮤니티 게시판 컨테이너 -->
<main class="site-body container-lg py-5" style="max-width: 960px;">

  <!-- ✅ 게시판 헤더 -->
  <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
    <h2 class="fw-bold text-light mb-0">자유게시판</h2>
    <form method="get" class="mb-3 d-flex justify-content-end">
      <input type="text" name="q" value="{{ request.GET.q }}" class="form-control w-100" placeholder="검색어 입력">
      <button type="submit" class="btn btn-outline-light ms-2">검색</button>
    </form>
    <a href="javascript:void(0);" class="btn btn-light btn-sm text-dark" onclick="fetchWithLoginCheck('{% url 'community_create' %}')">
      ✍ 글쓰기
    </a>       
  </div>

  <!-- ✅ 테이블 감싸는 카드 박스 -->
  <div class="shadow-sm rounded bg-white overflow-hidden border">
    <table class="table table-hover align-middle mb-0 text-center">
      <thead class="table-light">
        <tr>
          <th style="width: 5%;">#</th>
          <th class="text-start">제목</th>
          <th style="width: 20%;">작성자</th>
          <th style="width: 20%;">작성일</th>
        </tr>
      </thead>
      <tbody>
        {% for post in posts %}
        <tr {% if post.is_notice %}class="table-warning"{% endif %}>
          <td>{{ forloop.counter }}</td>
          <td class="text-start">
            <a href="{% url 'community_detail' post.id %}" class="text-dark text-decoration-none fw-semibold">

              {% if post.is_notice %}
                <span class="badge bg-warning text-dark me-1">공지</span>
              {% endif %}

              {{ post.title }}
            </a>
          </td>
          <td>{{ post.author.nickname }}</td>
          <td>{{ post.created_at|date:"Y.m.d H:i" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="py-4 text-muted">아직 게시글이 없습니다.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% include 'blog_base/pagination.html' %}
</main>
{% endblock content %}
