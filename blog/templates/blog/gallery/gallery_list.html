{% extends "blog_base/base_with_navbar.html" %}
{% load static %}

{% block title %}Gallery{% endblock title %}

{% block content %}

<main class="flex-grow-1 d-flex flex-column align-items-center justify-content-start mt-5">
  <div class="container text-center mb-4 position-relative" style="z-index: 10;">
    <a href="javascript:void(0);" class="btn btn-outline-light" onclick="fetchWithLoginCheck('{% url 'post_list_create' %}')">목록 작성</a>
  </div>

  <div class="container">
    <div class="row row-cols-1 row-cols-md-3 g-5">
      {% for post in posts %}
        <div class="col flex-fill">
          <div class="card card-custom h-100">
            {% if post.thumb %}
              <img src="{{ post.thumb.url }}" class="card-img-top" alt="{{ post.title }}">
            {% endif %}
            <div class="card-body d-flex flex-column">
              <h5 class="card-title text-white card-title-custom">{{ post.title }}</h5>
              <p class="card-text card-text-custom">{{ post.content }}</p>
              <div class="mt-auto">
                <p class="last mb-2">{{ post.created_at|date:"Y년 n월 j일" }}</p>
                <!-- ✅ 카드 전체 링크 처리 -->
                <a href="javascript:void(0);" class="stretched-link" onclick="fetchWithLoginCheck('{% url 'post_list_detail' post.id %}')"></a>
                {% if post.author == user %}
                  <div class="d-flex justify-content-end gap-2 position-relative">
                    <a href="{% url "post_list_edit" post.id %}" class="btn btn-sm btn-outline-light position-relative bi bi-pencil" style="z-index: 5;">수정</a>
                    <a href="{% url "post_list_delete" post.id %}" class="btn btn-sm btn-outline-light position-relative bi bi-trash" style="z-index: 5;">삭제</a>
                  </div>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</main>

{% endblock content %}